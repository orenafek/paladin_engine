<!--suppress CheckEmptyScriptTag -->
<!DOCTYPE html>
<!--suppress ALL -->
<meta charset="utf-8">
<head>
    <title>Paladin</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/agate.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.8.0/dist/highlightjs-line-numbers.min.js"></script>
    <script>hljs.initLineNumbersOnLoad();</script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="/static/index.js"></script>
</head>
<body>

<div id="app">
<div id="header">
    <h1 style="position: center">PaLaDiN: Time-travel Debugger</h1>
</div>
<div id="main">
<splitpanes class="default-theme">
<pane>
    <Codemirror id="source-editor" ref="sourceEditor" class="original-style"
                :value="source_code.join('\n')"
                :options="{mode: 'python', theme: 'darcula', scrollbarStyle: 'overlay'}"></Codemirror>
</pane>
<pane id="query-pane">
<div class="flex-container">
    <div v-if="exception_line_no != null"
         v-text="`The Program has stopped on line ${exception_line_no}: ${exception_source_line} with the message: ${exception_msg}, archive time: ${exception_archive_time}`"
         style="color: red;">
    </div>
    <div>
        <h3> Run Query: </h3>
        <Codemirror id="query_select" placeholder="Selection" :options="codemirror_options" :height="auto" :width="600"
                    style="font-size: 14pt;" @change="onQuerySelectChange" v-model:value="query_select"></Codemirror>

        <input v-model="query_start_time" type="number" placeholder="start"/>
        <input v-model="query_end_time" type="number" placeholder="end"/>
        <input v-model="query_line_no" type="number" placeholder="line number"/>
        <loading-spinner :submit_button_text="'Run'" v-model:is_loaded="is_query_done"
                         @loading-button-click="run_query"></loading-spinner>
        <!--        <button @click="run_query">Run</button>-->
        <br/>
        <textarea id="query_result" placeholder="Your results will appear in here"
                  style="height: auto; max-height: 200px; width: auto"></textarea>
        <tabular :value="tabular_query_result"></tabular>
    </div>
    <div>
        <h3>Create a time window:</h3>
        <br/>
        <input type="number" id="time_window_from" placeholder="Start Time">
        <input type="number" id="time_window_to" placeholder="End Time"/>
        <button @click="create_time_window()">
            Create time window
        </button>
        <div id="time_window_archive_table" style="visibility: hidden;" class="collapsible_archive_table_div">
            <table>
                <thead>
                    <td v-if="time_window.length > 0"
                        v-for="k in Object.keys(time_window[0])"
                        v-html="k.charAt(0).toUpperCase() + k.slice(1)"/>
                </thead>
                <tbody>
                <tr v-for="entry in time_window">
                    <td v-for="value, key in entry">
                        <highlighted :code="value"/>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div id="span_line_debug" style="visibility: hidden">
        <table>
            <thead>
            <td>
                <highlighted v-if="line_to_debug != null" :code="line_no_to_debug"/>
            </td>
            <td>
                <highlighted v-if="line_to_debug != null" :code="line_to_debug"/>
            </td>
            </thead>
        </table>
        <h3>Archive entries for line:</h3>
        <div class="collapsible_archive_table_div">
            <archive-Table :entries="archive_entries"></archive-Table>
            <!--            <table>-->
            <!--                <thead>-->
            <!--                    <td v-if="archive_entries.length > 0"-->
            <!--                        v-for="k in Object.keys(archive_entries[0])"-->
            <!--                        v-html="k.charAt(0).toUpperCase() + k.slice(1)"/>-->
            <!--                </thead>-->
            <!--                <tbody>-->
            <!--                <tr v-for="entry in archive_entries">-->
            <!--                    <td v-for="value, key in entry">-->
            <!--                        <highlighted :code="value"/>-->
            <!--                    </td>-->
            <!--                </tr>-->
            <!--                </tbody>-->
            <!--            </table>-->
        </div>
        </table>
    </div>
    <div>
        <table>

        </table>
        <!--        <table>-->
        <!--            <tr>-->
        <!--                <td> Select a var to follow:</td>-->
        <!--                <td>-->
        <!--                    <table>-->
        <!--                        <thead>-->
        <!--                        <td v-if="vars_to_follow.length > 0" v-for="k in Object.keys(vars_to_follow[0])"-->
        <!--                            v-html="capitalize(k)"/>-->

        <!--                        </thead>-->
        <!--                        <tr v-for="(target, target_index) in vars_to_follow">-->
        <!--                            <td v-for="(value, key, index) in target" :id="key + '_' + target_index">-->
        <!--                                <highlighted :code="value"/>-->
        <!--                            </td>-->
        <!--                            <td>-->
        <!--                                <button @click="objectLifetime(target['container_id'])">follow container</button>-->
        <!--                                <button @click="objectLifetime(target['value'])">follow value</button>-->
        <!--                            </td>-->
        <!--                        </tr>-->
        <!--                    </table>-->
        <!--                </td>-->
        <!--            </tr>-->
        <!--        </table>-->
    </div>

</div>
</pane>
</splitpanes>
</div> <!-- #main -->
</div> <!-- #app -->

</body>
