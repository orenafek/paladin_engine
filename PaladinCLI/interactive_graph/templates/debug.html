<!--suppress CheckEmptyScriptTag -->
<!DOCTYPE html>
<!--suppress ALL -->
<meta charset="utf-8">
<head>
    <title>Paladin</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/agate.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.8.0/dist/highlightjs-line-numbers.min.js"></script>
    <script>hljs.initLineNumbersOnLoad();</script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="/static/index.js"></script>
    <style type="text/css">
        body {
            background-color: #282727;
            color: white;
        }

        thead {
            color: #efc081;
            align-content: center;
            align-items: center;
        }

        .collapsible_archive_table_div {
            max-width: 1400px;
            max-height: 400px;
            overflow: scroll
        }
    </style>
</head>
<body>

<div id="header">
    <h1 style="position: center">Welcome to PaLaDiN Archive Debugger!</h1>
    <div v-if="exception_line_no != null"
         v-text="`The Program has stopped on line ${exception_line_no}: ${exception_source_line} with the message: ${exception_msg}, archive time: ${exception_archive_time}`"
         style="color: red;"/>
</div>
<h3>Select a line to start debuging:</h3>
<div class="flex-container">
    <div style="line-height: 1px; height: 550px; overflow-y: scroll;">
        <div v-for="(line, index) in source_code">
            <highlighted @click="select_line_no(index + 1)" :code="`${ index + 1} ${ line }`" :id="'code_' + index"/>
        </div>
    </div>
    <br/>
    <div>
        <h3> Run Query: </h3>
        <h4> Select: </h4>
        <Codemirror id="query_select" placeholder="Selection" :options="codemirror_options" :height="auto" :width="600"
                    style="font-size: 14pt;" @change="onQuerySelectChange"></Codemirror>

        <h4> Where:</h4>
        <div v-text="query_dsl_words"></div>
        <br/>
        <Codemirror id="query_where" placeholder="Type your query here" :options="codemirror_options" :height="auto"
                    :width="600" style="font-size: 14pt" @change="onQueryWhereChange"></Codemirror>
        <input id="query_start_time" type="number" placeholder="start"/>
        <input id="query_end_time" type="number" placeholder="end"/>
        <input id="query_line_no" type="number" placeholder="line number"/>
        <button @click="run_query">Run</button>
        <br/>
        <textarea id="query_result" placeholder="Your results will appear in here"
                  style="height: auto; max-height: 200px; width: auto"></textarea>
    </div>
    <div>
        <h3>Create a time window:</h3>
        <br/>
        <input type="number" id="time_window_from" placeholder="Start Time">
        <input type="number" id="time_window_to" placeholder="End Time"/>
        <button @click="create_time_window()">
            Create time window
        </button>
        <div id="time_window_archive_table" style="visibility: hidden;" class="collapsible_archive_table_div">
            <table>
                <theaed>
                    <td v-if="time_window.length > 0"
                        v-for="k in Object.keys(time_window[0])"
                        v-html="k.charAt(0).toUpperCase() + k.slice(1)"/>
                </theaed>
                <tbody>
                <tr v-for="entry in time_window">
                    <td v-for="value, key in entry">
                        <highlighted :code="value"/>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div id="span_line_debug" style="visibility: hidden">
        <table>
            <thead>
            <td>
                <highlighted v-if="line_to_debug != null" :code="line_no_to_debug"/>
            </td>
            <td>
                <highlighted v-if="line_to_debug != null" :code="line_to_debug"/>
            </td>
            </thead>
        </table>
        <h3>Archive entries for line:</h3>
        <div class="collapsible_archive_table_div">
            <archive-Table :entries="archive_entries"></archive-Table>
            <!--            <table>-->
            <!--                <theaed>-->
            <!--                    <td v-if="archive_entries.length > 0"-->
            <!--                        v-for="k in Object.keys(archive_entries[0])"-->
            <!--                        v-html="k.charAt(0).toUpperCase() + k.slice(1)"/>-->
            <!--                </theaed>-->
            <!--                <tbody>-->
            <!--                <tr v-for="entry in archive_entries">-->
            <!--                    <td v-for="value, key in entry">-->
            <!--                        <highlighted :code="value"/>-->
            <!--                    </td>-->
            <!--                </tr>-->
            <!--                </tbody>-->
            <!--            </table>-->
        </div>
        </table>
    </div>
    <div>
        <table>

        </table>
        <!--        <table>-->
        <!--            <tr>-->
        <!--                <td> Select a var to follow:</td>-->
        <!--                <td>-->
        <!--                    <table>-->
        <!--                        <thead>-->
        <!--                        <td v-if="vars_to_follow.length > 0" v-for="k in Object.keys(vars_to_follow[0])"-->
        <!--                            v-html="capitalize(k)"/>-->

        <!--                        </thead>-->
        <!--                        <tr v-for="(target, target_index) in vars_to_follow">-->
        <!--                            <td v-for="(value, key, index) in target" :id="key + '_' + target_index">-->
        <!--                                <highlighted :code="value"/>-->
        <!--                            </td>-->
        <!--                            <td>-->
        <!--                                <button @click="objectLifetime(target['container_id'])">follow container</button>-->
        <!--                                <button @click="objectLifetime(target['value'])">follow value</button>-->
        <!--                            </td>-->
        <!--                        </tr>-->
        <!--                    </table>-->
        <!--                </td>-->
        <!--            </tr>-->
        <!--        </table>-->
    </div>

</div>

</body>
